---
name: specify
description: 仕様を定義する
---

<!--
このファイルはSDD Phase 1 (Specify) を遂行するためのプロンプトテンプレートであり、入力として課題の概要・期待成果・制約を受け取り、出力としてドメイン文脈と受け入れ条件を備えた最小仕様書を生成する。制約としてFP/DDD/TDD原則と自己記述コメント方針に整合し、後続フェーズが即座に着手できる粒度を保つ。
-->

!!!次フェーズに進む前にユーザーへ確認を求める（「確認不要」指定が無い限り自動遷移しない）!!!

## 実行原則

- ユビキタス言語で語彙を統一し、ビジネス価値とユーザー成果を先に明文化する
- ユーザージャーニーを起点に「As/When/Then」形式のユーザーストーリーで成功状態を固定する
- 最低2案（推奨3案）のBest-of-N候補を生成し、評価指標とリスクを比較して最適案を選出する
- 候補比較後は各候補ごとに個別ファイルへ保存できるドラフトを提示し、`specs/<feature-number>-<feature-name>/specify-<candidate-id>.md` に落とし込める形式に整える
- DDDコンテキスト境界とFPスタイルのデータフローをセットで描写し、後続Plan/Tasksが迷わない粒度にする
- 受け入れ条件と非機能要件をセットで示し、TDDシナリオとトレーサビリティを確保する
- 曖昧さや仮定は `[NEEDS CLARIFICATION]` を付けて明示し、Phase 5 Knowledgeへ確実に接続する
- 生成物は `specs/[feature-number]-[feature-name]/` 配下へ保存するファイル名の推奨を明記する

## 出力テンプレート

```markdown
# Specify

## 0. メタ情報
- 推奨保存先: `specs/<feature-number>-<feature-name>/specify-<candidate-id>.md`
- 入力ソース/関連Issue:
- 作成日:

## 1. ミッションと成功判定
- 課題要約:
- ユーザー/アクター:
- ユーザーストーリー (As a [role], When [situation], I want [goal] so that [outcome]):
- 期待するビジネス価値:
- 成功指標 (定量/定性):

## 2. コンテキストと制約
- コンテキスト境界:
- 利用シーン / ユーザージャーニー:
- 既存システム/外部依存:
- 技術/組織制約:
- 前提・除外:

## 3. ユビキタス言語
| 用語 | 定義 | 備考 |
|------|------|------|
|      |      |      |

## 4. 候補案 (Best-of-N)
### 候補A
- 要約:
- 強み:
- リスク/前提:
- 推奨保存ファイル例: `specs/<feature-number>-<feature-name>/specify-A.md`
### 候補B
- 要約:
- 強み:
- リスク/前提:
- 推奨保存ファイル例: `specs/<feature-number>-<feature-name>/specify-B.md`
### （必要なら候補C以降を追加）

## 5. 候補比較と選定
- 評価指標 (価値/実現容易性/リスク等):
- ベスト候補:
- 選定理由:
- 採用しない候補の補足:

## 6. 候補別ファイルドラフト
- 以下のコードフェンスを提示し、各候補ファイルを即時生成できるようにする
- 必要に応じて候補C以降も同形式で追加する
### `specs/<feature-number>-<feature-name>/specify-A.md`
```markdown
# Specify Candidate A
- ミッション要約:
- コンテキスト境界:
- 主要メリット:
- 主なリスク/前提:
- 想定API/ドメインオブジェクト:
- 次のアクション:
```

### `specs/<feature-number>-<feature-name>/specify-B.md`

```markdown
# Specify Candidate B
- ミッション要約:
- コンテキスト境界:
- 主要メリット:
- 主なリスク/前提:
- 想定API/ドメインオブジェクト:
- 次のアクション:
```

### （必要なら `specs/<feature-number>-<feature-name>/specify-C.md` 以降を追加）

## 7. 機能要件

- [ ] 要件1
- [ ] 要件2

## 8. 入出力契約

- 入力チャネル/形式:
- 出力/副作用:
- エラーパターン:
- データ整合と不変条件:

## 9. 受け入れ基準（テスト観点）

- [ ] 観点1
- [ ] 観点2

### describe: <ユースケース名>

- context: <前提>
  - it: <期待結果>
- context: <境界/例外>
  - it: <期待結果>

## 10. 非機能と品質属性

- 性能/スループット:
- 信頼性/可用性:
- セキュリティ/コンプライアンス:
- 運用・可観測性（ログ/メトリクス）:
- 拡張性/その他リスク:

## 11. 曖昧さと前提 ([NEEDS CLARIFICATION] を付与)

- [NEEDS CLARIFICATION] 例:
- 仮定:

## 12. オープンクエスチョン

- まだ決まっていないこと:
- 検証すべき仮説:
- Phase 5で更新すべきドキュメント:

## 13. 次フェーズ進行確認

- Planningへ進む条件:
- ユーザー確認依頼メッセージ案: 例）「候補A/Bの仕様ドラフトを `specs/<feature-number>-<feature-name>/specify-A.md` と `.../specify-B.md` として生成可能な形で提示しました。これらを保存し、次フェーズへ進めてよいですか？」

```
