---
name: implements
description: フェーズ4で実装と検証を行う
---

<!--
このファイルはSDD Phase 4 (Implement) を遂行するためのプロンプトテンプレート。入力はPhase 2 PlanとPhase 3 Tasksで定義された責務・タスク・依存、出力はTDDサイクルの記録、具体的なコード/テスト変更方針、品質検証結果、ハンドオフ情報。FP/DDD境界・自己記述コメント・t-wadaスタイルTDDを順守したインクリメントであることが制約。
-->

## 実行原則

- Ready定義を満たしたタスクのみ着手し、ドメイン/アプリ/インフラの責務を跨ぐ変更は明示的に記録する
- タスク着手時には `/implement <タスクID>` 形式で編集対象・完成条件を宣言し、完了時に達成状況を報告する
- TDD (Red→Green→Refactor) の各ループを可観測化し、describe/it単位で振る舞いの証跡を残す
- Scott Wlaschin流の関数型分解を意識し、副作用はポート/アダプタに隔離、純粋関数は単体テストで守る
- Eric Evans/増田亨のユビキタス言語をコード/コメント/テスト名に反映し、自己記述コメントで仕様トレースを担保する
- 変更差分や補足メモは `specs/[feature-number]-[feature-name]/implementation-log.md` 等に追記し、docs/architecture-specification.md の更新意図を保持する
- リファクタや設計判断はADR候補として整理し、Phase 5 Knowledgeへ確実にハンドオフする
- 次フェーズ（Knowledge）に進む前にユーザーへ確認を求める（「確認不要」の指示が無ければ自動遷移しない）

## 出力テンプレート

```markdown
# Implement

## 0. メタ情報
- 実行コマンド例: `/implement <タスクID> --summary "<タスク内容>" --targets "<編集対象>" --done "<完成条件>"`
- 推奨ログ保存先: `specs/<feature-number>-<feature-name>/implementation-log.md`
- 参照タスクファイル:
- 作業日/担当:

## 1. 対象タスクとゴール
- 参照タスクID/リンク:
- 目的と期待成果物:
- 依存タスクの完了状況:
- スコープ外:

## 2. 実装ストラテジ
- 採用するFP/DDDパターン (例: pipeline, interpreter, ports/adapters):
- 主要インターフェース/データ契約と更新方針:
- エラーハンドリングと回復戦略:
- コメント/ドキュメント追加方針:

## 3. TDDサイクルログ
| ループ | describe/it | Red: 失敗テストと理由 | Green: 追加/変更概要 | Refactor: 調整内容 |
|--------|--------------|------------------------|----------------------|---------------------|
| 1      |              |                        |                      |                     |

## 4. 実装メモ (Domain/App/Infra)
- Domain層: 変更点 / 新規関数 / 不変条件
- Application層: ユースケース調整 / オーケストレーション
- Infra層: ポート実装 / Gateway / 設定
- 自己記述コメントやファイル先頭コメントで追記した内容:
- 追記・更新したドキュメント/コードの保存先 (`specs/...` や `docs/architecture-specification.md` 等):

## 5. 品質検証
- 実行したテストコマンド (npm test 等) と結果:
- 静的解析/フォーマッタ/型チェック:
- 観測性・ログ・メトリクスの追加:
- パフォーマンス/セキュリティ確認 (必要ならベンチ/スキャン):

## 6. リスクとフォローアップ
- 既知の技術的負債や暫定実装:
- 追加で必要なスパイク/検証:
- リリース/マージ条件:

## 7. ハンドオフ
- PR/レビュー依頼先:
- 更新したドキュメント/ADR:
- Phase 5 Knowledge で追記すべき学び:

## 8. 次フェーズ進行確認
- Knowledgeへ進む条件:
- ユーザー確認依頼メッセージ案:
```
